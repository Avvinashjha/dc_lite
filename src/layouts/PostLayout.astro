---
import BaseLayout from './BaseLayout.astro';
import { formatDate } from '../utils/formatDate';
import { calculateReadingTime } from '../utils/readingTime';

interface Props {
  title: string;
  description: string;
  date: Date;
  author: string;
  image?: string;
  tags: string[];
  category: string;
  content: string;
}

const { title, description, date, author, image, tags, category, content } = Astro.props;
const readingTime = calculateReadingTime(content);
---

<BaseLayout
  title={`${title} | My Blog`}
  description={description}
  image={image}
  type="article"
  publishedTime={date}
  author={author}
  tags={tags}
>
  <article class="article">
    <div class="container content">
      <header class="article__header">
        <div class="article__meta">
          <time datetime={date.toISOString()}>{formatDate(date)}</time>
          <span>•</span>
          <span>{readingTime}</span>
          <span>•</span>
          <span>{author}</span>
        </div>
        
        <h1 class="article__title">{title}</h1>
        
        <p class="article__description">{description}</p>
        
        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: center; margin-top: 1rem;">
          <a href={`/blog/category/${category}`} class="tag">
            {category}
          </a>
          {tags.map(tag => (
            <a href={`/blog/tag/${tag}`} class="tag">
              {tag}
            </a>
          ))}
        </div>
      </header>
      
      {image && (
        <img
          src={image}
          alt={title}
          class="article__image"
          loading="eager"
        />
      )}
      
      <div class="article__content">
        <slot />
      </div>
      
      <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--color-border);">
        <h3>Share this article</h3>
        <div style="display: flex; gap: 1rem; margin-top: 1rem;">
          <a
            href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(Astro.url.href)}`}
            target="_blank"
            rel="noopener noreferrer"
            class="button button--secondary"
          >
            Twitter
          </a>
          <a
            href={`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(Astro.url.href)}`}
            target="_blank"
            rel="noopener noreferrer"
            class="button button--secondary"
          >
            Facebook
          </a>
          <a
            href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(Astro.url.href)}`}
            target="_blank"
            rel="noopener noreferrer"
            class="button button--secondary"
          >
            LinkedIn
          </a>
          <button
            onclick={`navigator.clipboard.writeText('${Astro.url.href}'); alert('Link copied!')`}
            class="button button--secondary"
          >
            Copy Link
          </button>
        </div>
      </div>
    </div>
  </article>
</BaseLayout>
