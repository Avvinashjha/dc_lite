---
// Pagefind search component
// Pagefind generates /pagefind/pagefind-ui.js and /pagefind/pagefind-ui.css at build time
---

<div class="search">
  <link href="/pagefind/pagefind-ui.css" rel="stylesheet" />
  <div id="search"></div>
</div>

<script is:inline>
  window.addEventListener('DOMContentLoaded', function() {
    var script = document.createElement('script');
    script.src = '/pagefind/pagefind-ui.js';
    script.onload = function() {
      new PagefindUI({
        element: '#search',
        showSubResults: true,
        showImages: false,
      });
    };
    script.onerror = function() {
      document.getElementById('search').innerHTML =
        '<input type="search" placeholder="Search posts..." class="search__input" disabled />' +
        '<p style="font-size:0.875rem;color:var(--color-text-light);margin-top:0.5rem;">Search available on the deployed site.</p>';
    };
    document.head.appendChild(script);
  });
</script>

<style>
  :global(#search) {
    margin: 2rem 0;
  }
  :global(.pagefind-ui__search-input) {
    width: 100% !important;
    padding: 0.75rem 1rem !important;
    border: 1px solid var(--color-border) !important;
    border-radius: var(--radius-md) !important;
    background: var(--color-surface) !important;
    color: var(--color-text) !important;
    font-size: 1rem !important;
  }
  :global(.pagefind-ui__search-input:focus) {
    outline: none !important;
    border-color: var(--color-primary) !important;
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1) !important;
  }
  :global(.pagefind-ui__result) {
    border: 1px solid var(--color-border) !important;
    border-radius: var(--radius-md) !important;
    padding: 1rem !important;
    margin-bottom: 0.75rem !important;
    background: var(--color-surface) !important;
  }
  :global(.pagefind-ui__result-link) {
    color: var(--color-primary) !important;
    font-weight: 600 !important;
  }
  :global(.pagefind-ui__result-excerpt) {
    color: var(--color-text-light) !important;
    font-size: 0.875rem !important;
  }
  :global(.pagefind-ui__message) {
    color: var(--color-text-light) !important;
  }
  :global(.pagefind-ui__form::before) {
    opacity: 0.5;
  }
</style>
